# TypeScript и ООП (8 спринт) + ООП в интерфейсах: простые и не только концепции (9 спринт)
## Проектная работа WEB-ларёк
### Оглавление
- [Установка и запуск](#установка-и-запуск)
- [Базовые классы](#базовые-классы)
    - [Класс `EventEmitter`](#1-класс-eventemitter)
    - [Класс `Copmonent`](#2-класс-copmonent)
    - [Класс `Api`](#3-класс-api)
    - [Класс `Model`](#4-класс-model)
- [Модель (Model)](#модель-model)
    - [Класс `AppDada`](#1-класс-appdada)
    - [Класс `ShopAPI`](#2-класс-shopapi)
- [Представления (View)](#представления-view)
    - [Общие компоненты:](#1-общие-компоненты)
        - [Класс `Basket`](#11-класс-basket)
        - [Класс `Form`](#12-класс-form)
        - [Класс `Modal`](#13-класс-modal)
        - [Класс `Success`](#14-класс-success)
    - [Классы представления карточек](#2-классы-представления-карточек)
        - [Класс `Card`](#21-класс-сard)
        - [Класс `CardPreview`](#22-класс-cardpreview)
        - [Класс `CardBasket`](#23-класс-cardbasket)
    - [Класс `Contacts`](#3-класс-contacts)
    - [Класс `Order`](#4-класс-order)
    - [Класс `Page`](#5-класс-page)
- [Презентер (Presenter)](#презентер-presenter)
    - [События в приложении](#события-в-приложении)
- [Основные типы и интерфейсы](#основные-типы-и-интерфейсы)
___
Стек: HTML, SCSS, TS, Webpack\
Архитектурный паттерн: MVP (Model View Presenter)
___
Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом
- src/components/common/ - папка с общими JS компонентами

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

### Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
### Сборка

```
npm run build
```

или

```
yarn build
```
___
[:arrow_up:Оглавление](#Оглавление)
___
## Базовые классы
### 1. Класс `EventEmitter`
Классический брокер событий, суть которого слушать и подписывать/отписывать на события
Методы:
- `on` — установить обработчик на событие
- `off` — снять обработчик с события
- `emit` — инициировать событие
- `onAll` — слушать все события
- `offAll` — сбросить все обработчики
- `trigger` — сделать коллбек триггер, генерирующий событие при вызове
---
### 2. Класс `Copmonent`
Класс представления (View), который обеспечивает базовый функционал для дочерних компонентов
Методы:
- `toggleClass` — переключить класс
- `setText` — устанавливить текстовое содержимое
- `setDisabled` — сменить статус блокировки
- `setHidden` — скрыть компонент
- `setVisible` — показать компонент
- `setImage` — устанавить изображение с альтернативным текстом
- `render` — вернуть корневой DOM-элемент
---
### 3. Класс `Api`
Шаблон для создания объекта взаимодействия с API сервером, посредством HTTP-запросов

Методы:
- `handleResponse` — вернуть ответ сервера или сообщить об ощибке
- `get` — GET-запрос
- `post` — POST-запрос
---
### 4. Класс `Model`
Базовая модель, чтобы можно было отличить ее от простых объектов с данными
Методы:
- `emitChanges` — сообщить всем, что модель поменялась
___
[:arrow_up:Оглавление](#Оглавление)
___
## Модель (Model)
### 1. Класс `AppDada`
Класс описывает объект данных приложения и инкапсулирует функциональность работы с этими данными. Наследуется от базового класса `Model`

Поля:
- `catalog` — массив товаров
- `preview` — идентификатор для предпросмотра товара
- `loading` — состояние отправки/получения данных
- `order` — свойство типа объект, информации о заказе
- `formErrors` — данные валидации формы

Методы:
- `setCatalog` — записывает в `catalog`, переданный в виде параметра, массив товаров и иницирует событие `items:changed`
- `setPreview` — записывает в `preview` `id` товара, переданного в виде параметра, и иницирует событие `preview:changed`
- `getBasketItems` — возвращает массив товаров добавленный в заказ
- `getTotal` — возвращает сумму всех элементов добавленных в заказ
- `inOrder` — добавляет или удаляет товар в заказ и иницирует событие `basket:changed`
- `checkInOrder` — проверяет есть ли товар в заказе, возвращает логический ответ
- `setOrderTotal` — записывае общую сумму в заказ
- `clearBasket` — очищает массив товаров в заказе
- `setOrderField` — записывает в заказ значения свойств оплаты и адреса
- `setContactsField` — записывает в заказ значения свойст почты и телефона
- `validateOrder` — валидирует свойства оплаты и адреса
- `validateContacts` — валидирует свойства почты и телефона
---
### 2. Класс `ShopAPI`

Поля:
- `cdn` — адрес CDN-ресурса, доступен только для чтения

Методы:
- `getProductList` — GET-запрос массива товаров
- `postOrder` — POST-запрос объекта заказа
___
[:arrow_up:Оглавление](#Оглавление)
___
## Представления (View)
### 1. Общие компоненты:
#### 1.1 Класс `Basket`
Представление для корзины приложения. Наследуется от базового класса `Component`

Поля:
- `_list` — элементы корзины
- `_total` — элемент суммы заказа
- `_button` — элемент кнопки оформления, иницирует событие `order:open`

Методы
- `set items` — сеттер записывающий в поле `_list` элементы
- `set total` — сеттер записывающий в `textContent` поля `_total` итоговую сумму элементов корзины
---
#### 1.2 Класс `Form`
Представление для форм приложения. Наследуется от базового класса `Component`

Поля:
- `_submit` — элемент кнопки отправки формы
- `_errors` — элемент ошибок валидации

Методы:
- `onInputChange` — инициирует событие вида `${this.container.name}.${field}:change` для возможности прослушивания на каждом `input`
- `set valid` — сеттер переключающий состояние кнопки `_submit` `(disabled = true || disabled = false)`
- `set errors` — сеттер записывающий в `_error` текст ошибки
- `render` — обновление состояния формы
---
#### 1.3 Класс `Modal`
Представление для модальных окон приложения. Наследуется от базового класса `Component`

Поля:
- `_closeButton` — элемент кнопки закарытиия
- `_content` — элемент для контента

Методы:
- `set content` — сеттер записывающий в `_content` контент
- `open` — открытие модального окна
- `close` — закрытие модального окна
- `render` — обновление состояния модального окна
---
#### 1.4 Класс `Success`
Представление окна подтверждения заказа. Наследуется от базового класса `Component`

Поля:
- `_close` — элемент кнопки закрытия
- `_total` — элемент суммы заказа

Методы:
- `set total` — сеттер записывающий в `textContent` поля `_total` значение
---
### 2. Классы представления карточек
#### 2.1 Класс `Card`
Представление для карточки каталого. Наследуется от базового класса `Component`

Поля:
- `_category` — элемент категории
- `_title` — элемент заголовка
- `_image` — элемент изображения
- `_price` — элемент цены

Методы:
- `set category` — сеттер записывающий в `textContent` поля `_category` значение и добавляет соответствующий класс
- `set title` — сеттер записывающий в `textContent` поля `_title` значение
- `set image` — сеттер записывающий в поле `_image` нужные атрибуты
- `set price` — сеттер записывающий в `textContent` поля `_price` значение
---
#### 2.2 Класс `CardPreview`
Предстовление для карточки предпросмотра. Наследуется от класса `Card`

Поля:
- `_description` — элемент описания
- `_button` — элемент кнопки

Методы:
- `set description` — сеттер записывающий в `textContent` поля `_description` значение
- `set price` — сеттер вызывающий родительский метод и переключающий состояние кнопки `_bitton` `(disabled = true || disabled = false)`
- `toggleButton` — переписывает текст кнопки
---
#### 2.3 Класс `CardBasket`
Предстовление для карточки корзины. Наследуется от базового класса `Component`

Поля:
- `_index` — элемент индекса
- `_title` — элемент заголовка
- `_price` — элемент цены
- `_button` — элемент кнопки удаления

Методы:
- `set index` — сеттер записывающий в `textContent` поля `_index` значение
- `set title` — сеттер записывающий в `textContent` поля `_title` значение
- `set price` — сеттер записывающий в `textContent` поля `_price` значение
---
### 3. Класс `Contacts`
Представление для окна контактной информации. Наследуется от общего класса `Form`
Методы:
- `set email` — сеттер записывающий в элемент текущее значение
- `set phone` — сеттер записывающий в элемент текущее значение
---
### 4. Класс `Order`
Представление для окна выюора способа оплаты и адреса. Наследуется от общего класса `Form`

Поля:
- `_buttons` — массив элементов кнопок оплаты

Методы:
- `setPayment` — выбор способа оплаты, перекалючение классов кнопок
- `set address` — сеттер записывающий в элемент текущее значение
---
### 5. Класс `Page`
Представление всей страницы приложения. Наследуется от базового класса `Component`

Поля:
- `_counter` — элемент счетчика корзины
- `_catalog` — элемент каталога
- `_wrapper` — элемент обертки контента
- `_basket` — элемент корзины

Методы:
- `set counter` — сеттер записывающий в `_counter` количество добавленных товаров в корзину
- `set catalog` — сеттер записывающий в `_catalog` элементы
- `set locked` — сеттер блокирующий прокрутку страницы
____
[:arrow_up:Оглавление](#Оглавление)
____
## Презентер (Presenter)
Выполняет роль посредника между представлением и моделью. Находится в точке входа в приложения `src/index.ts`. Взаимодействие происходит через брокер событий.

### События в приложении
Инициализирует модель:
- `items:changed` — изменился массив каталога товаров
- `preview:changed` — изменился предпросмотр товара
- `basket:changed` — изменилася список корзины
- `formErrors:change` — изменилась валидация заказа

Инициализирует представление:
- `${form}:submit` — сабмит форм
- `${form}.{field}:change` — изменениизменение поля формы
- `modal:open` — открытие модального окна
- `modal:close` — закрытие модального окна
- `card:select` — выбор карточки
- `basket:open` — открытие корзины
- `order:open` — открытие формы заказа
____
[:arrow_up:Оглавление](#Оглавление)
____
## Основные типы и интерфейсы
- `IProduct` — свойства объекта продукта
- `IAppData` — свойства модели
- `IOrderForm` — свойства объекта заказ (форма оплаты и адрес)
- `IContactsForm` — свойства объекта контакты (почта и телефон)
- `IOrder` — свойства объекта заказ
- `FormErrors` — типизация ошибок форм
- `IOrderResult` — свойства объекта ответа сервера на заказ
